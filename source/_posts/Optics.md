---
title: Optics
top: false
cover: false
toc: true
description: Optics
categories:
  - Optics
tags:
  - Optics
abbrlink: "92992653"
date: 2025-12-10 14:20:15
password:
summary:
---

# 哈特曼利用斜率测量相位的原理

## 光波相位的数学表达与分解

光波是空间和时间的函数，光波在四维空间中的表达式为：

$$\mathbf{E}(\mathbf{r},t) = \mathbf{E}_0 e^{i(\phi(\mathbf{r}) - \omega t)}$$

其中

- $\phi(\mathbf{r}) = \mathbf{k}\cdot\mathbf{r} + \phi_0(\mathbf{r})$
- $\mathbf{k}\cdot\mathbf{r}$ 是平面波基准项（理想传播相位），即相位的线性部分
- $\phi_0(\mathbf{r})$ 是像差/畸变引入的附加相位

$$\mathbf{E}(\mathbf{r},t) = \mathbf{E}_0 e^{i(\mathbf{k}\cdot\mathbf{r} + \phi_0(\mathbf{r}) - \omega t)}$$

对于存在像差的实际波前，
$\phi_0(\mathbf{r})$ 是$\mathbf{r}$的
非线性畸变函数，常用Zernike多项式展开，像散、离焦等。
（一次或线性部分都可包含在$\mathbf{k}\cdot\mathbf{r}$中）。

**常数项（Piston）**

- **数学**：$\phi_{\text{piston}} = C$
- **物理**：整个波前相位整体平移一个常数
- **成像影响**：**完全不影响**
  - 所有光线相位改变量相同
  - 干涉/衍射图样不变
  - 人眼/探测器无法感知绝对相位

**一次项（Tip-tilt）**

- **数学**：$\phi_{\text{tilt}} = a_x x + a_y y$
- **物理**：波前整体倾斜，光线方向偏转
- **成像影响**：**影响像的位置，但不影响像的质量**
  - **像整体平移**：光斑质心位移 $\Delta x = f \cdot \theta$
  - **分辨率不变**：点扩散函数（PSF）形状不变
  - **应用**：精跟踪系统专门校正此项

**二次及以上项（真正影响成像质量）**

- **二次项**：离焦、像散 → **模糊、离焦**
- **三次项**：彗差 → **不对称拖尾**
- **四次项**：球差 → **中心亮环**

这些项会**改变PSF形状**，导致：

- 分辨率下降
- 对比度降低
- 细节丢失

- **常数项**：无法测量（所有子孔径光斑同步移动）
- **一次项**：表现为**所有子孔径斜率整体偏移**
  - 测量：$\langle S_x \rangle, \langle S_y \rangle$ 不为零
  - 校正：由倾斜镜（Tip-tilt Mirror）快速补偿
- **高阶项**：各子孔径斜率**差异** → 需要变形镜（DM）校正

## **光线方向与相位梯度的关系**

$$\mathbf{E}(\mathbf{r},t) = \mathbf{E}_0 e^{i(\phi(\mathbf{r}) - \omega t)}$$

根据 **程函方程（Eikonal Equation）** ，光线传播方向由**相位的空间梯度**决定：
$$\mathbf{k}(\mathbf{r}) = \nabla \phi(\mathbf{r}) = \left( \frac{\partial \phi}{\partial x}, \frac{\partial \phi}{\partial y}, \frac{\partial \phi}{\partial z} \right)$$

**物理意义**：光线始终**垂直于等相位面**（波前）传播，且
$||\mathbf{k}(\mathbf{r})||_2 = 2\pi / \lambda$。（根据程函方程，均匀介质中，
相差只改变传播的方向，即波矢的方向随空间位置变化，但其模长恒定。
**相差的本质是波矢的横向调制。**）

**<font color=red>
光波的局部传播方向由相位梯度的方向决定。
因此可以通过测量波前斜率（即光线偏转角）来测量传播方向，再通过传播方向来反推相位梯度，
再利用积分重建算法恢复波前相位分布。这是哈特曼测量相位的基本原理。
</font>**

## **哈特曼传感器中的二维简化**

根据 **程函方程（Eikonal Equation）** ，光线传播方向由**相位的空间梯度**决定：
$$\mathbf{k}(\mathbf{r}) = \nabla \phi(\mathbf{r}) = \left( \frac{\partial \phi}{\partial x}, \frac{\partial \phi}{\partial y}, \frac{\partial \phi}{\partial z} \right)$$

在实际哈特曼探测器的每一个子孔径内，光的传播方向为:
$$\mathbf{S}=  \left( \Delta x,\Delta y,f \right)$$
其中$\Delta x, \Delta y$分别为哈特曼子孔径质心的偏移量，$f$为子孔径透镜的焦距。

$\mathbf{k}(\mathbf{r})$和$\mathbf{S}$都代表光的传播方向，
只是一个是从波矢的角度，一个是实际物理测量的结果。他俩方向一致，
只有模长的区别。

因此,

$$
\left(\frac{\partial \phi/\partial x}{\partial \phi/\partial z},\frac{\partial \phi/\partial y}{\partial \phi/\partial z} , 1 \right)=
\left( \Delta x/f,\Delta y/f, 1\right)
$$

由于$||\mathbf{k}(\mathbf{r})||_2 = 2\pi / \lambda$，
在**近轴近似**下，$\partial\phi/\partial z$占主导，
$\partial\phi/\partial x$和$\partial\phi/\partial y$可忽略，
则
$\partial\phi/\partial z = \frac{2\pi}{\lambda}$ 为常数，因此：

$$\frac{\partial \phi/\partial x}{\partial \phi/\partial z} = \frac{\partial\phi}{\partial x}  \cdot \frac{\lambda}{2\pi} = \frac{\Delta x}{f}$$
$$\frac{\partial \phi/\partial y}{\partial \phi/\partial z} = \frac{\partial\phi}{\partial y}  \cdot \frac{\lambda}{2\pi} = \frac{\Delta y}{f}$$

$\frac{\partial\phi}{\partial x}$和$\frac{\partial\phi}{\partial y}$的
单位为弧度/米，表征波前相位角在x和y方向的空间变化率。

设
$$\frac{\partial\Phi}{\partial x} = \frac{\partial\phi}{\partial x}  \cdot \frac{\lambda}{2\pi}$$
$$\frac{\partial\Phi}{\partial y} = \frac{\partial\phi}{\partial y}  \cdot \frac{\lambda}{2\pi}$$
其中
$\partial\Phi = \partial\phi \cdot \frac{\lambda}{2\pi}$可以看成
相位从弧度单位到长度单位的转化，因此，
$\frac{\partial\Phi}{\partial x}$和
$\frac{\partial\Phi}{\partial y}$
的单位为长度/长度（无量纲），表征长度相位在x和y方向上的空间变化率，即长度相位的梯度。
（专业点说是：光程差。长度相位的说法并不专业，但是我理解起来好一些）

$$\frac{\partial\Phi}{\partial x} =\frac{\Delta x}{f}$$
$$\frac{\partial\Phi}{\partial y} = \frac{\Delta y}{f}$$
因此，斜率$\frac{\Delta x}{f}$和$\frac{\Delta y}{f}$波前在x和y方向的局部倾斜，
表征长度相位在x和y方向上的空间变化率，即长度相位的梯度。

### **斜率测量阶段，离散化计算$\frac{\Delta x}{f}$和$\frac{\Delta y}{f}$**

对每个子孔径 $(i,j)$：

- **光斑质心定位**：采用高阶矩算法
  $$\bar{x}_{i,j} = \frac{\sum_{m,n} x_{nm} I_{nm}^\alpha}{\sum_{m,n} I_{nm}^\alpha}$$
  计算精度达**0.1像素**，可计算对应波前测量精度**RMS**。

- **斜率计算**：
  $$\frac{\Delta x}{f} = \frac{\bar{x}_{i,j} - x_{0,i,j}}{f}, \quad \frac{\Delta y}{f} = \frac{\bar{y}_{i,j} - y_{0,i,j}}{f}$$
  其中 $f$ 为微透镜焦距，$(x_{0,i,j}, y_{0,i,j})$ 为参考光斑位置。

### 波前重建阶段，离散化表示 $\frac{\partial\Phi}{\partial x}$和 $\frac{\partial\Phi}{\partial y}$

利用 **Hudgin离散模型** 构建线性方程组：
$$\frac{\partial\Phi}{\partial x} = \frac{\Phi_{i+1,j} - \Phi_{i,j}}{d} = \frac{\Delta x}{f}$$
$$\frac{\partial\Phi}{\partial y} = \frac{\Phi_{i,j+1} - \Phi_{i,j}}{d} = \frac{\Delta y}{f}$$

其中$d$为子孔径间距，单位一般为$\mu m$。也正是由于
$\frac{\partial\Phi}{\partial x} = \frac{\Phi_{i+1,j} - \Phi_{i,j}}{d} = \frac{\Delta x}{f}$和
$\frac{\partial\Phi}{\partial y} = \frac{\Phi_{i,j+1} - \Phi_{i,j}}{d} = \frac{\Delta y}{f}$
的单位为长度/长度（无量纲）。
而$d$的单位为$\mu m$，因此，一般哈特曼测量出来$\Phi_{i,j}$的单位为$\mu m$。

- **矩阵形式**：$\mathbf{A}\boldsymbol{\Phi} = \mathbf{S}$

  - $\boldsymbol{\Phi}$：待求的长度相位向量（在光瞳圆内部，个数为哈特曼子孔径数目，对于$14\times14$的哈特曼，其个数为196）
  - $\mathbf{S}$：测量斜率向量（由$\frac{\Delta x}{f}$和$\frac{\Delta y}{f}$确定，每个有效子孔径测量x、y两个方向斜率，对于$14\times14$的哈特曼，共296个方程，即148个有效子孔径$\times 2$方向）
  - $\mathbf{A}$：稀疏差分矩阵（元素为 $\pm 1/d$，）

- **求解方法**：采用**最小二乘法**或**奇异值分解(SVD)** 求解超定方程组，
  得到各子孔径中心处的相对相位。

### **像差分析阶段：Zernike多项式分解**

将重建的长度相位 $\Phi(x,y)$ 投影到**Zernike多项式**基底：
$$\Phi(\rho,\theta) = \sum_{n=0}^{N} \sum_{m=-n}^{n} a_{nm} Z_n^m(\rho,\theta)$$

- **系数 $a_{nm}$**：直接对应经典像差（如 $a_{20}$ 为离焦，$a_{22}$ 为像散，$a_{11}$、$a_{1,-1}$ 为倾斜）
- **去除平移与倾斜**：常数项（piston）和一次项（tip-tilt）不影响成像质量，可剥离
- **高阶像差校正**：将Zernike系数反馈至**变形镜（DM）**，驱动镜面形变实现波前补偿

### **哈特曼测量原理的核心总结**

**从波矢到长度相位的完整转换链条**：

1. **物理测量**：光斑位移 $(\Delta x, \Delta y, f)$ 反映局部传播方向
2. **斜率计算**：$\frac{\Delta x}{f} = \frac{\partial\Phi}{\partial x}$ 建立测量与理论的桥梁
3. **离散建模**：Hudgin差分方程将连续梯度转化为线性方程组
4. **数值求解**：通过矩阵反演重建长度相位分布 $\boldsymbol{\Phi}$
5. **像差提取**：Zernike分解得到可校正的像差系数

# 振幅和强度

振幅指复振幅（Complex Amplitude），
它同时包含幅值和相位信息，
是描述光场完整状态的复数，无法直接测量；

强度（Intensity）是复振幅的模（幅值）的平方，
对应探测器实际响应的光功率密度，
因此可以测量。

| 术语                           | 数学表达式                | 性质 | 物理意义                  |     |     |
| ------------------------------ | ------------------------- | ---- | ------------------------- | --- | --- |
| **复振幅** (Complex Amplitude) | $\tilde{E} = A e^{i\phi}$ | 复数 | 完整描述光场（幅值+相位） |     |     |
| **实振幅** (Amplitude)         | $A = \tilde{E}$           | 实数 | 复振幅的模（幅值大小）    |
| **强度** (Intensity)           | $I = \tilde{E} ^2 = A^2$  | 实数 | 可测量的光功率密度        |

# 光的传播方向与相位的关系

## **三维平面波的数学形式**

沿任意方向传播的平面波电场：
$$\mathbf{E}(\mathbf{r},t) = \mathbf{E}_0 e^{i(\mathbf{k}\cdot\mathbf{r} - \omega t)}$$

其中：

- $\mathbf{r} = (x,y,z)$ 是位置矢量
- $\mathbf{k} = (k_x, k_y, k_z)$ 是波矢（常矢量）

波矢的模长和光的波长有关，为$2 \pi/\lambda$，是相位在空间上的变化快慢。

波矢方向垂直于等相位面（波前），波矢的方向就是光的传播方向。

---

### **相位函数**

空间相位部分为：
$$\phi(\mathbf{r}) = \mathbf{k}\cdot\mathbf{r} = k_x x + k_y y + k_z z$$

（时间部分 $-\omega t$ 对空间梯度无贡献）

---

### **计算相位梯度**

对 $\phi(\mathbf{r})$ 求梯度：

$$
\nabla\phi = \left(\frac{\partial}{\partial x}, \frac{\partial}{\partial y}, \frac{\partial}{\partial z}\right)(k_x x + k_y y + k_z z)
$$

逐项求导：

$$
\nabla\phi = \left(k_x, k_y, k_z\right) = \mathbf{k}
$$

**结果一目了然：相位梯度 ∇φ 就是波矢 k 本身！**

### **等相面与传播方向**

- **等相面方程**：$\phi = \mathbf{k}\cdot\mathbf{r} = \text{常数}$

  - 这是一个**平面**，法向量就是 $\mathbf{k}$

- **梯度方向**：∇φ = k 垂直于等相面

- **传播方向**：能量沿 $\hat{\mathbf{s}} = \frac{\mathbf{k}}{|\mathbf{k}|}$ 流动

### **具体数值例子**

设波沿 $(1,1,0)$ 方向传播，在真空中波长 $\lambda = 500\,\text{nm}$：

- **波矢大小**：$k = 2\pi/\lambda = 1.26\times10^7\,\text{m}^{-1}$
- **归一化方向**：$\hat{\mathbf{s}} = \frac{1}{\sqrt{2}}(1,1,0)$
- **波矢分量**：$\mathbf{k} = k\hat{\mathbf{s}} = \frac{k}{\sqrt{2}}(1,1,0)$
- **相位**：$\phi = \frac{k}{\sqrt{2}}(x + y)$

**梯度计算**：
$$\nabla\phi = \frac{k}{\sqrt{2}}(1,1,0) = \mathbf{k}$$

**对于平面波，相位梯度 ∇φ 直接等于波矢 k，其方向完美决定了光的传播方向。**

# 光的干涉

光的干涉是指两列或多列相干光波叠加时，在叠加区域内光强呈现稳定的不均匀分布现象。

产生条件（相干条件）两列波必须满足：

频率相同（波长相同）

振动方向相同（偏振不垂直）

相位差恒定（相干性）

两列相干光波的总电场矢量形式）：
$$\mathbf{E}_{\text{total}}(\mathbf{r},t) = \mathbf{A}_1 e^{i(\mathbf{k}_1\cdot\mathbf{r} - \omega_1 t + \phi_1)} + \mathbf{A}_2 e^{i(\mathbf{k}_2\cdot\mathbf{r} - \omega_2 t + \phi_2)}$$

**观测光强**（时间平均）：
$$I(\mathbf{r}) = \langle |\mathbf{E}_{\text{total}}|^2 \rangle = \frac{\epsilon_0 c}{2} \langle \mathbf{E}_{\text{total}} \cdot \mathbf{E}_{\text{total}}^* \rangle$$

## **干涉发生的理想情况（条件都满足）**

**条件**：$\omega_1 = \omega_2 = \omega$，$\mathbf{A}_1 \parallel \mathbf{A}_2$，$\Delta\phi = \phi_2 - \phi_1 = \text{常数}$

**干涉项**：
$$I_{\text{int}}(\mathbf{r}) = 2A_1A_2\cos[(\mathbf{k}_2-\mathbf{k}_1)\cdot\mathbf{r} + \Delta\phi]$$

**结果**：稳定的明暗条纹！能量在空间周期性再分配。

## **条件不满足时：频率不同 $\omega_1 \neq \omega_2$**

**代入**：
$$\mathbf{E}_{\text{total}} = \mathbf{A}_1 e^{i(\mathbf{k}_1\cdot\mathbf{r} - \omega_1 t + \phi_1)} + \mathbf{A}_2 e^{i(\mathbf{k}_2\cdot\mathbf{r} - \omega_2 t + \phi_2)}$$

**干涉项**含时间：
$$I_{\text{int}}(\mathbf{r},t) \propto 2A_1A_2\cos[(\omega_1-\omega_2)t + \text{空间项}]$$

**时间平均**（探测器响应时间远大于光周期）：
$$\langle\cos[(\omega_1-\omega_2)t + \dots]\rangle = 0$$

**结果**：$I(\mathbf{r}) = I_1 + I_2$（均匀照明），**条纹消失**。

**物理**：相位差每秒旋转 $|\omega_1-\omega_2|$ 次，条纹移动太快，眼睛/探测器看到的是时间平均。

## **条件不满足时：偏振垂直 $\mathbf{A}_1 \perp \mathbf{A}_2$**

**设**：$\mathbf{A}_1 = \hat{\mathbf{x}}A_1$，$\mathbf{A}_2 = \hat{\mathbf{y}}A_2$

**计算点积**：
$$\mathbf{E}_1 \cdot \mathbf{E}_2^* = \hat{\mathbf{x}}\cdot\hat{\mathbf{y}} \cdot A_1A_2 e^{i(\dots)} = 0$$

**干涉项**：
$$I_{\text{int}} \propto 2\text{Re}\{\mathbf{E}_1 \cdot \mathbf{E}_2^*\} = 0$$

**结果**：$I = I_1 + I_2$（均匀照明），**无干涉**。

**物理**：电场在正交方向振动，无法相互"调制"，就像上下跳和左右跳的人不会互相抵消。

---

## **条件不满足时：相位差不恒定 $\Delta\phi(t)$ 随机**

**设**：$\phi_2(t) = \phi_2 + \delta\phi(t)$，$\delta\phi(t)$ 随机跳变

**干涉项**：
$$I_{\text{int}}(\mathbf{r},t) \propto 2A_1A_2\cos[\Delta\mathbf{k}\cdot\mathbf{r} + \Delta\phi + \delta\phi(t)]$$

**统计平均**（长时间观测）：
$$\langle\cos[\dots + \delta\phi(t)]\rangle = 0$$

**结果**：$I = I_1 + I_2$（均匀照明），**条纹模糊消失**。

**物理**：条纹位置每秒随机移动无数次，最终平均成均匀背景。这就是普通光源（如灯泡）不能产生干涉的原因——原子发光相位随机。

| 条件         | 公式中的体现                          | 干涉消失原因 |
| ------------ | ------------------------------------- | ------------ |
| **频率不同** | $e^{-i\omega t}$ 项不同               | 时间平均归零 |
| **偏振垂直** | $\mathbf{A}_1 \cdot \mathbf{A}_2 = 0$ | 干涉项恒为零 |
| **相位随机** | $\phi(t)$ 随机                        | 统计平均归零 |

**干涉的本质**：**时间稳定、方向平行、频率相同**的相位关系，使复振幅叠加产生可观测的强度调制。任一条件破坏，干涉项在物理观测中即消失。

# 成像与光的干涉

**从波动光学的本质来看，成像就是干涉的结果！**

## **两种光学视角**

### **几何光学视角（传统）**

- **描述**：光线追迹，透镜折射
- **观点**：像是"光线直接投射"形成的，不涉及干涉
- **局限**：无法解释分辨率极限、衍射现象

### **波动光学/傅里叶光学视角（现代，更本质）**

- **描述**：光作为波传播
- **核心观点**：**物体→空间频率分解→传播→像面干涉重构**
- **优势**：能完整解释所有成像现象

## **成像的波动光学本质：干涉重构**

根据**阿贝成像原理**，物体（透射函数 $O(x,y)$）可分解为无数平面波：
$$O(x,y) = \iint \tilde{O}(k_x,k_y) e^{i(k_x x + k_y y)} dk_x dk_y$$

这些平面波经过透镜后，在**像面发生干涉**：
$$I_{\text{image}}(x',y') = \left|\sum_{\mathbf{k}} \tilde{O}(\mathbf{k}) e^{i\mathbf{k}\cdot\mathbf{r}'}\right|^2$$

**结论**：像面上的光强分布，是**携带物体信息的所有平面波成分干涉叠加**的结果。

## **具体例子**

### **点光源成像（分辨率极限）**

一个理想点光源发出的球面波，经透镜后在像面**干涉形成艾里斑**（Airy pattern）：
$$I(r) = I_0 \left[\frac{2J_1(krNA)}{krNA}\right]^2$$

**中心亮斑 + 同心圆环** = 典型的**衍射+干涉图样**。

**物理**：这是**有限的孔径**导致高频空间频率丢失（被截断），剩余成分干涉只能形成有限大小的斑，而非理想点。

### **相位反差显微镜**

- **样品**：透明细胞（只改变相位，不改变强度）
- **直接成像**：几乎看不见（强度均匀）
- **原理**：在傅里叶面**相位板**使零频成分产生 $\pi/2$ 相位延迟
- **结果**：相位信息→强度变化，**干涉使不可见相位变得可见**

### **全息成像**

- **记录**：物光波 + 参考光波 → **干涉条纹**记录在底片
- **再现**：参考光照射底片 → **衍射重构**原物光波
- **本质**：完全是干涉的记录与再现过程

## **为什么日常感觉"不像干涉"？**

- **非相干照明**（灯泡）：不同点源之间**相位随机**，整体光强是**强度叠加**（非相干叠加）
- **相干照明**（激光）：相位关系固定，**复振幅叠加**（干涉）

**即使非相干照明**，每个物点发出的光经系统后，**自身衍射斑的形成仍是干涉**，只是不同物点之间不相干。

## **关键结论**

| 成像类型                     | 是否干涉   | 描述                               |
| ---------------------------- | ---------- | ---------------------------------- |
| **相干成像**（激光、显微镜） | **明确是** | 像面是各空间频率成分的干涉图样     |
| **非相干成像**（日常）       | **部分**   | 各点自身衍射是干涉，点间是强度叠加 |
| **理想几何光学（无衍射）**   | 不是       | 数学极限，物理不存在               |

**最终答案**：**成像本质上是波动的干涉与衍射过程**。所有成像系统的分辨率极限、像差、调制传递函数(MTF)等，都源于**空间频率的传递与干涉重构**。

现代光学设计（如超分辨、超表面透镜）正是通过**精确调控光的相位和干涉**来实现。

# 光的衍射

光的衍射是指光波遇到障碍物或通过有限孔径时，偏离直线传播并向几何阴影区扩展的现象。这是光的波动性的又一核心证据，本质上是波前受限后产生的无限子波干涉。

惠更斯-菲涅尔原理：
波前上的每一点都是次级子波源，发射球面子波，这些子波的相干叠加构成新的波前。

无障碍：子波叠加后保持平面波（向前传播）

有障碍：边缘处子波无抵消 → 向阴影区弯曲

| 特性     | **干涉**                     | **衍射**                     |
| -------- | ---------------------------- | ---------------------------- |
| **波源** | 有限个（几个到几十个）相干波 | 无限多个子波（波前连续分割） |
| **数学** | 离散求和 $\sum_n$            | 连续积分 $\int dS$           |
| **物理** | 波的叠加                     | 波的叠加                     |
| **条件** | 需要相干光源                 | 任何波遇到障碍都发生         |
| **本质** | **有限波叠加**               | **无限子波叠加**             |

# 时间频率和空间频率

沿任意方向传播的平面波电场：
$$\mathbf{E}(\mathbf{r},t) = \mathbf{E}_0 e^{i(\mathbf{k}\cdot\mathbf{r} - \omega t)}$$
，其相位是时间和空间的函数，所以有时间频率和空间频率。

时间频率（光频）： 描述光波随时间振荡的快慢，对于单色光，时间频率是常数。

空间频率：相位在空间上的周期性变化；正是这种相位变化的快慢，在波叠加时通过干涉决定了最终图像光强的精细程度。

对不同空间频率的传递能力不同（光学传递函数OTF描述）。

| 维度 | 频率             | 描述什么变化快慢 | 例子                  |     |     |
| ---- | ---------------- | ---------------- | --------------------- | --- | --- |
| 时间 | $\omega$         | 时间上的振荡快慢 | 颜色（红橙黄绿）      |     |     |
| 空间 | 波矢$\mathbf{k}$ | 空间上的振荡快慢 | 纹理粗细（粗纹/细纹） |

**空间频率描述的是相位的空间变化，而不是光强的空间变化。**

对于平面波：
$$\tilde{E}(\mathbf{r}) = E_0 e^{i\mathbf{k}\cdot\mathbf{r}}$$

- **空间频率**：$\mathbf{k}$ 或 $|\mathbf{k}|$
- **物理意义**：**相位** $\phi(\mathbf{r}) = \mathbf{k}\cdot\mathbf{r}$ 在空间变化的快慢

**重要事实**：对于**单个平面波**，其光强是**均匀的**：
$$I = |\tilde{E}|^2 = |E_0|^2 = \text{常数}$$
**没有空间变化**！

**在图像形成时的情况**。当**多个不同空间频率的平面波叠加**时：

$$\tilde{E}_{\text{total}}(\mathbf{r}) = \sum_{\mathbf{k}} A_{\mathbf{k}} e^{i\mathbf{k}\cdot\mathbf{r}}$$

此时**总光强**：
$$I(\mathbf{r}) = |\sum_{\mathbf{k}} A_{\mathbf{k}} e^{i\mathbf{k}\cdot\mathbf{r}}|^2$$

由于**交叉项**（干涉），光强**不再是均匀**的，其空间变化模式**反映了各相位空间频率成分的相对关系**。

1. **本质定义**：

   - 时间频率 $\omega$：**相位的时间变化率**（$-\partial\phi/\partial t$）
   - 空间频率 $\mathbf{k}$：**相位的空间变化率**（$\nabla\phi$）

1. **在成像中的表现**：
   - **高频的空间相位成分** → 干涉形成**快速变化的光强细节**（边缘、纹理）
   - **低频的空间相位成分** → 干涉形成**缓慢变化的光强轮廓**

# 相消干涉

## **数学条件**

两个平面波在位置 $\mathbf{r}$ 的复振幅：

- 波1：$\tilde{E}_1 = A_1 e^{i\phi_1}$
- 波2：$\tilde{E}_2 = A_2 e^{i\phi_2}$

叠加结果：
$$\tilde{E}_{\text{total}} = \tilde{E}_1 + \tilde{E}_2$$

**完全抵消的条件（理想情况）**：

1. **振幅相等**：$A_1 = A_2 = A$
2. **相位差为 $\pi$（即180°）**：$\phi_2 = \phi_1 + \pi$

此时：
$$\tilde{E}_{\text{total}} = A e^{i\phi_1} + A e^{i(\phi_1+\pi)} = A e^{i\phi_1} \underbrace{(1 + e^{i\pi})}_{=0} = 0$$

## **物理实例**

1. **驻波的波节**：两列反向传播的等幅平面波形成驻波，在某些点（波节）振幅恒为零。
2. **反反射涂层**：设计薄膜厚度使上下表面反射光完全相消。
3. **迈克尔逊干涉仪**：调节光程差，可使某位置光强为零（暗纹）。
4. **光学陷阱**：两束激光干涉形成周期性零点，用于捕获冷原子。

## **关键点**

- 复振幅为0 → **光强** $I = |\tilde{E}|^2 = 0$（完全黑暗）
- 这是**局域**的：只在满足相位条件的空间点才发生
- 能量守恒：此处能量为0，必然在别处有相长干涉（能量加倍）

局域抵消不违背能量守恒，因为能量从暗区转移到了亮区，总能量不变。如果所有区域同时相消（全局为零），那才是违背能量守恒，但这种情况在物理上不可能发生。

局域性：干涉是强度在空间再分配，不是能量消灭

时间平均：瞬时能量密度可能局域为零，但时间平均总能量守恒

坡印亭矢量：相消区域能流为零，能量"绕道"流向相长区域

# 瞳函数、点扩散函数和光学传递函数

## 瞳函数（Pupil Function）（复数域，包含幅值和相位）

$$
P(x) = w(x) \exp[2\pi i\phi(x)]
$$

- $x$：瞳面空间坐标
- $w(x)$：振幅（孔径内为1，孔径外为0）
- $\phi(x)$：波前相位误差（孔径外振幅为0，相位无意义）
- $P(x)$：复振幅，无量纲
- $w(x)$：振幅传输函数，无量纲
- $\phi(x)$：波前相位，**无量纲**，单位为**波长数（waves）**

**相位项的物理意义**：

- 在光学中，相位 = $2\pi \times$（光程差 / 波长）
- 当光程差 = 1个波长时，相位 = $2\pi$ 弧度，对应一个完整周期

因此，$\phi(x)$ 必须是无量纲的"波长数"，才能正确产生 $2\pi i \phi(x)$ 的相位因子。

哈特曼探测器就是在测量瞳函数的相位梯度

| 测量对象                 | 哈特曼探测器                             |
| :----------------------- | :--------------------------------------- |
| **瞳函数振幅 $w(x)$**    | 子孔径总光强（积分）                     |
| **瞳函数相位 $\phi(x)$** | 局部斜率（梯度）→ 积分重建，间接测量相位 |

### **5. 论文依据：公式验证**

让我们对照论文Phase-diversity wave-front sensor for imaging systems，验证每个公式的单位：

| 公式编号 | 表达式                                       | $\phi(x)$单位 | 验证                                |
| -------- | -------------------------------------------- | ------------- | ----------------------------------- |
| (1)      | $P(x)=w(x)e^{2\pi i\phi(x)}$                 | **无量纲**    | 指数必须为无量纲，故$\phi(x)$无量纲 |
| (3)      | $h(\xi)=\| \int P(x)e^{-2\pi i\xi x}dx \|^2$ | -             | $P(x)$无量纲，积分结果无量纲        |
| (12)     | $M_4 = \frac{A_o^2 - A_d^2}{A_o^2 + A_d^2}$  | -             | 所有量均为功率谱，无量纲            |

**结论**：整个算法链中，**波前值必须是无量纲的波长数**，否则指数项将具有**物理错误**的单位。

## 点扩散函数（Point Spread Function, PSF）（实数域，强度）

$$
h(\xi) = \left|\int P(x) \exp(-2\pi i \xi x) \, dx\right|^{2}
$$

- $\xi$：像面空间坐标
- 公式含义：瞳函数的傅里叶变换取模平方

实际上，哈特曼探测器和在焦相机就是在光路里面实现了对瞳函数（变形镜 处）
和点扩散函数的测量，
成像透镜就是实现了瞳函数到点扩散函数之间的傅里叶变换。

## 光学传递函数（Optical Transfer Function, OTF）(复数域)

$$
H_o(f) = N_o \int P(x)P^{*}(x-f) \, dx
$$

- $f$：空间频率
- $N_o$：归一化常数
- 公式含义：瞳函数的自相关函数（其实就是点扩散函数的傅里叶变换，因为根据维纳-辛钦定理，点扩散函数是瞳函数傅里叶变换的模平方，对其再作傅里叶变换就等价于瞳函数的自相关运算）

- 模 $|H_o(f)|$ → **调制传递函数（MTF）**（实数，描述对比度衰减）
- 相位角 $\arg(H_o(f))$ → **相位传递函数（PTF）**（描述相位偏移）

### 光学传递函数的物理意义

任何**线性不变系统**（光学系统是其一）满足：

> **正弦输入 → 同频正弦输出，仅幅度/相位改变**

1. **输入**：一个**正弦光栅**（条纹强度按正弦规律变化）
   数学形式：$I_{\text{in}}(x) = I_0 [1 + \cos(2\pi\xi_0 x)]$
   $\xi_0$ 就是其**空间频率**

2. **系统响应**：该光栅经过光学系统后
   - 仍是同一频率的正弦条纹（线性系统保频特性）
   - 但**对比度下降**（幅度衰减）
   - **位置偏移**（相位变化）

输出：

$$
I_{\text{out}}(x) = I_0 \left[1 + |H(\xi_0)| \cos\left(2\pi\xi_0 x + \arg H(\xi_0)\right)\right]
$$

- **$|H(\xi_0)|$** ：该频率下的**对比度衰减系数** → **MTF**
- **$\arg H(\xi_0)$**：该频率下的**相位偏移** → **PTF**

---

#### **点扩散函数的作用**

1. **PSF** 是系统的**脉冲响应**：点光源 $\delta(x)$ 的成像结果
   $$h(x) = \text{系统}\{\delta(x)\}$$

2. **卷积定理**：任意输入 $I_{\text{in}}(x)$ 的输出是
   $$I_{\text{out}}(x) = I_{\text{in}}(x) * h(x)$$
   （$*$ 表示**卷积**）

3. **频域关系**：对两边做傅里叶变换
   $$\mathcal{F}\{I_{\text{out}}\} = \mathcal{F}\{I_{\text{in}}\} \cdot \mathcal{F}\{h\}$$

4. **定义OTF**：
   $$H(\xi) = \mathcal{F}\{h(x)\}$$

**点扩散函数是系统在空域的脉冲响应，其傅里叶变换OTF就是系统在频域的频率响应函数，直接给出每个空间频率正弦条纹的对比度衰减和相位偏移量，因此完整表征了系统的传递能力。**

## 三者关系链

$$
\text{瞳函数 } P(x) \xrightarrow{\text{傅里叶变换}} \text{场分布 } \mathcal{F}\{P(x)\} \xrightarrow{|\cdot|^{2}} \text{PSF } h(\xi) \xrightarrow{\text{傅里叶变换}} \text{OTF } H_o(f)
$$

# 透镜与傅里叶变换

波前的空间频率分量对应着不同传播角度的平面波，
透镜将这些角度信息变换为焦平面的位置信息，因此透镜相当于把空间频率直接映射为位置信息，实现了傅里叶变换。

相位梯度正比于局部空间频率（或波前倾斜角），
因此哈特曼探测器通过测量子孔径的角度信息直接获得相位梯度，进而积分重建瞳函数的相位分布。

$$
$$
